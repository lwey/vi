#通用配置
mixed-port: 7890
redir-port: 7891
tproxy-port: 1536
mode: rule
allow-lan: true
ipv6: false
unified-delay: true
tcp-concurrent: true
enable-process: true
log-level: silent

geodata-mode: true     #true时geoip.文件为dat格式，false时为mmdb格式
geodata-loader: standard
geo-auto-update: true
geo-update-interval: 168
geox-url:
  geoip: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geoip.dat"
  geosite: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/geosite.dat"
  mmdb: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/country.mmdb"
  asn: "https://github.com/MetaCubeX/meta-rules-dat/releases/download/latest/GeoLite2-ASN.mmdb"

#匹配进程
find-process-mode: strict
keep-alive-idle: 15
keep-alive-internal: 30
global-client-fingerprint: chrome

#控制面板
external-controller: 0.0.0.0:9090
#面板默认Meta 可选Yacd 清除浏览器缓存即可重新加载
external-ui: /data/adb/box_bll/panel/Zash/ #/Meta #/Yacd
external-ui-url: "https://github.com/Zephyruso/zashboard/archive/refs/heads/gh-pages.zip"
secret: ""

profile:
  store-selected: true
  store-fake-ip: true

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - "+.v2ex.com"
  skip-domain:
    - "Mijia Cloud"

tun:
  enable: true 
  device: Mihomo
  stack: mixed
  dns-hijack:
    - "any:53"
    - "tcp://any:53"
  auto-route: true
  strict-route: true
  auto-redirect: false
  auto-detect-interface: true
  route-exclude-address:
    - 192.168.0.0/16
    - fc00::/7
  exclude-package: #

dns:
  enable: true
  prefer-h3: true
  ipv6: true
  listen: 0.0.0.0:1053
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.0/15
  fake-ip-filter:
    - "*"
    - "+.lan"
    - "connect.rom.miui.com"
    - "localhost.ptlogin2.qq.com"
  default-nameserver:
    - 223.5.5.5
    - 223.6.6.6
    - 119.29.29.29
  nameserver-policy:
    'geosite:category-ads-all': rcode://success
    'geosite:jd,tencent,meituan,zhihu,huya,douyu,bilibili,pinduoduo':
      - https://doh.pub/dns-query
    'geosite:aliyun,alibaba,alibabacloud,netease,eleme,sina':
      - https://dns.alidns.com/dns-query
    'geosite:bytedance,tiktok':
      - 180.184.1.1
      - 180.184.2.2
    'geosite:private,cn':
      - https://dns.alidns.com/dns-query
      - https://doh.pub/dns-query
  nameserver:
    - https://dns.google/dns-query
    - https://cloudflare-dns.com/dns-query
  proxy-server-nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query  
    
#proxies自建
proxies:
  #- {name: type: ss, server: 111.9.146.195, port: "52173", cipher: chacha20-ietf-poly1305, password: juhwygalmcnbvsenuakypz, udp: true}
  
#proxy-groups：策略组
proxy-groups:

  - {name: 🚀select, type: select, use: [Sub], proxies: [DIRECT]}
  
  - {name: 📟 Telegram, type: select, proxies: [ 🇭🇰HongKong, 🇹🇼Taiwan, 🇺🇸American, 🇸🇬Singapore, 🇯🇵Japan]}

  - {name: 🐦 Twitter, type: select, proxies: [🇭🇰HongKong, 🇹🇼Taiwan, 🇺🇸American, 🇸🇬Singapore, 🇯🇵Japan]}
  
  - {name: 📽️ YouTube, type: select, proxies: [ 🇭🇰HongKong, 🇹🇼Taiwan, 🇺🇸American, 🇸🇬Singapore, 🇯🇵Japan]}
  
  - {name: 🖥️ 微软服务, type: select, proxies: [🇭🇰HongKong, 🇹🇼Taiwan, 🇺🇸American, 🇸🇬Singapore, 🇯🇵Japan]}

  - {name: 🌌 Google, type: select, proxies: [🇭🇰HongKong, 🇹🇼Taiwan, 🇺🇸American, 🇸🇬Singapore, 🇯🇵Japan]}
  
  - {name: 🏁Final, type: select, proxies: [🚀select, DIRECT]}
  
  - {name: 🇭🇰HongKong, type: url-test, filter: "(?i)香港|Hongkong|hong kong", use: [Sub], health-check: {enable: true, url: "https://i.ytimg.com/generate_204", interval: 1200, tolerance: 50}}
  
  - {name: 🇹🇼Taiwan, type: url-test, filter: "(?i)台湾|Taiwan", use: [Sub], health-check: {enable: true, url: "https://i.ytimg.com/generate_204", interval: 1200, tolerance: 50}}
  
  - {name: 🇸🇬Singapore, type: url-test, filter: "(?i)新加坡|狮城|SG|Singapore", use: [Sub], health-check: {enable: true, url: "https://i.ytimg.com/generate_204", interval: 1200, tolerance: 50}}
  
  - {name: 🇯🇵Japan, type: url-test, filter: "(?i)日本|JP|Japan", use: [Sub], health-check: {enable: true, url: "https://i.ytimg.com/generate_204", interval: 1200, tolerance: 50}}
  
  - {name: 🇺🇸American, type: url-test, filter: "🇺🇸|United States|美国", use: [Sub], health-check: {enable: true, url: "https://i.ytimg.com/generate_204", interval: 1200, tolerance: 50}}
  
#rule-providers：远程分流规则
rule-providers:

  Reject: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/yifai/Clash/main/Rules/Reject.yaml", path: ./providers/rule/Reject.yaml, interval: 864000}
  
  China: {type: http,behavior: classical, url: "https://raw.githubusercontent.com/yifai/Clash/main/Rules/China.yaml", path: ./providers/rule/China.yaml, nterval: 864000}
  
  📟 Telegram: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/Telegram.yaml", path: ./ruleset/Telegram.yaml, interval: 864000}
  
  📽️ YouTube: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/YouTube.yaml", path: ./ruleset/YouTube.yaml, interval: 864000}
    
  🖥️ 微软服务: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/yifai/Clash/main/Rules/Microsoft.yaml", path: ./providers/rule/Microsoft.yaml, interval: 864000}
  
  🌌 Google: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/Google.yaml", path: ./ruleset/Google.yaml, interval: 864000}

  🐦 Twitter: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/Providers/Ruleset/Twitter.yaml", path: ./ruleset/Twitter.yaml, interval: 864000}
    
  Proxy: {type: http, behavior: classical, url: "https://raw.githubusercontent.com/yifai/Clash/main/Rules/Proxylite.yaml", path: ./providers/rule/Proxy.yaml, interval: 864000}
  
# rules规则由上往下遍历，如上面规则已经命中，则不再往下处理
rules:
  #本地/局域网
  - DOMAIN-SUFFIX,ip6-localhost,DIRECT,no-resolve
  - DOMAIN-SUFFIX,ip6-loopback,DIRECT,no-resolve
  - DOMAIN-SUFFIX,local,DIRECT,no-resolve
  - DOMAIN-SUFFIX,localhost,DIRECT,no-resolve
  - DOMAIN-SUFFIX,lan,DIRECT,no-resolve
  
  #其它

  - PROCESS-NAME,BitComet,DIRECT
  - PROCESS-NAME,qbittorrent,DIRECT
  - DOMAIN-SUFFIX,yowindow.ru,DIRECT
  - DOMAIN-SUFFIX,yowindow.com,DIRECT
  
  # 策略分流RULE-SET
  - RULE-SET,Reject,REJECT
  - RULE-SET,📟 Telegram,📟 Telegram
  - RULE-SET,📽️ YouTube,📽️ YouTube
  - RULE-SET,🖥️ 微软服务,🖥️ 微软服务
  - RULE-SET,🌌 Google,🌌 Google
  - RULE-SET,🐦 Twitter,🐦 Twitter
  - RULE-SET,Proxy,🏁Final
  - RULE-SET,China,DIRECT
  
  # GEOIP ，如你不希望进行 DNS 解析，可在 GEOIP 规则的最后加上 ,no-resolve，如 GEOIP,CN,DIRECT,no-resolve。
  #GEOIPCN，ChinaIP二选一
  - GEOIP,CN,DIRECT,no-resolve
  
  # 必须，MATCH，前面的规则都没有命中，走MATCH，放在最后。
  - MATCH,🏁Final